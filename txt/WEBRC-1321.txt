 Optimize query execution through refactoring and caching 
